# language: es

Característica: generar remitos
módulo que genera remitos busando pedidos pendients de genereción para una fecha

# Primer escenario --------------------------------------------

Escenario: generar remitos con fecha "2020-05-13" quedando algunos artículos pendientes por falta de stock
Dado los articulos tienen el siguiente stock
  | articulo | stock |
  | 1000     | 65    |
  | 1001     | 750   |
  | 2000     | 1522  |
  | 3000     | 35    |
  | 3001     | 100   |
  | 4000     | 4     |
  | 5000     | 100   |
  | 6000     | 4     |   
Y que existen los siguientes artículos pedidos de pedidos anteriores a la fecha "2020-05-12" sin remito aún
  | Pedido | fechaPedido | Cliente | Domicilio | articulo | cantidad | precio | 
  | 1      | 2020-05-12  | 1000    | 1001      | 1000     | 10       | 2.3    |
  | 1      | 2020-05-12  | 1000    | 1001      | 1001     | 40       | 3.1    |
  | 1      | 2020-05-12  | 1000    | 1001      | 2000     | 125      | 3.4    |
  | 1      | 2020-05-12  | 1000    | 1001      | 3000     | 6        | 0.45   |
  | 1      | 2020-05-12  | 1000    | 1001      | 3001     | 10       | 0.77   |
  | 1      | 2020-05-12  | 1000    | 1001      | 4000     | 1        | 390    |
  | 2      | 2020-05-12  | 1000    | 1002      | 1000     | 10       | 2.3    |
  | 2      | 2020-05-12  | 1000    | 1002      | 1001     | 40       | 3.1    |
  | 2      | 2020-05-12  | 1000    | 1002      | 2000     | 125      | 3.4    |
  | 2      | 2020-05-12  | 1000    | 1002      | 3000     | 6        | 0.45   |
  | 2      | 2020-05-12  | 1000    | 1002      | 3001     | 10       | 0.77   |
  | 2      | 2020-05-12  | 1000    | 1002      | 4000     | 1        | 390    |
  | 3      | 2020-05-12  | 2000    | 2001      | 1000     | 10       | 2.3    |
  | 3      | 2020-05-12  | 2000    | 2001      | 1001     | 40       | 3.1    |
  | 3      | 2020-05-12  | 2000    | 2001      | 2000     | 125      | 3.4    |
  | 3      | 2020-05-12  | 2000    | 2001      | 3000     | 6        | 0.45   |
  | 3      | 2020-05-12  | 2000    | 2001      | 3001     | 10       | 0.77   |
  | 3      | 2020-05-12  | 2000    | 2001      | 4000     | 1        | 390    |
  | 4      | 2020-05-12  | 2000    | 2001      | 1000     | 10       | 2.3    |
  | 4      | 2020-05-12  | 2000    | 2001      | 1001     | 40       | 3.1    |
  | 4      | 2020-05-12  | 2000    | 2001      | 2000     | 125      | 3.4    |
  | 4      | 2020-05-12  | 2000    | 2001      | 3000     | 6        | 0.45   |
  | 4      | 2020-05-12  | 2000    | 2001      | 3001     | 10       | 0.77   |
  | 4      | 2020-05-12  | 2000    | 2001      | 4000     | 1        | 390    |
  | 5      | 2020-05-12  | 3000    | 3001      | 1000     | 10       | 2.3    |
  | 5      | 2020-05-12  | 3000    | 3001      | 1001     | 40       | 3.1    |
  | 5      | 2020-05-12  | 3000    | 3001      | 2000     | 125      | 3.4    |
  | 5      | 2020-05-12  | 3000    | 3001      | 3000     | 6        | 0.45   |
  | 5      | 2020-05-12  | 3000    | 3001      | 3001     | 10       | 0.77   |
  | 5      | 2020-05-12  | 3000    | 3001      | 4000     | 1        | 390    |
  | 6      | 2020-05-12  | 4000    | 4001      | 1000     | 10       | 2.3    |
  | 6      | 2020-05-12  | 4000    | 4001      | 1001     | 40       | 3.1    |
  | 6      | 2020-05-12  | 4000    | 4001      | 2000     | 125      | 3.4    |
  | 6      | 2020-05-12  | 4000    | 4001      | 3000     | 6        | 0.45   |
  | 6      | 2020-05-12  | 4000    | 4001      | 3001     | 10       | 0.77   |
  | 6      | 2020-05-12  | 4000    | 4001      | 4000     | 1        | 390    |
  | 7      | 2020-05-12  | 5000    | 5002      | 1000     | 10       | 2.3    |
  | 7      | 2020-05-12  | 5000    | 5002      | 1001     | 40       | 3.1    |
  | 7      | 2020-05-12  | 5000    | 5002      | 2000     | 125      | 3.4    |
  | 7      | 2020-05-12  | 5000    | 5002      | 3000     | 6        | 0.45   |
  | 7      | 2020-05-12  | 5000    | 5002      | 3001     | 10       | 0.77   |
  | 7      | 2020-05-12  | 5000    | 5002      | 4000     | 1        | 390    |
Cuando solicito generar remitos para pedidos con fecha "2020-05-13"
Entonces se obtiene el siguiente resultado:
  """
  {
    "StatusCode": 200,
    "StatusText": "Remitos generados exitosamente",
    "data": {
      "cantidad": 6
    }
  }
  """
Y se generaron los siguientes remitos
  | Remito|Entregado|     Fecha |         Domicilio |
  |      1|   false | 2020-05-13|               1001|
  |      2|   false | 2020-05-13|               1002|
  |      3|   false | 2020-05-13|               2001|
  |      4|   false | 2020-05-13|               3001| 
  |      5|   false | 2020-05-13|               4001|   
  |      6|   false | 2020-05-13|               5002|

Y se prepararon para la entrega los siguientes articulos pedido
  |   Cliente| DomicilioPedido|   Remito| DomicilioRemito|   articulo|cantidad|
  |      1000|            1002|        2|            1002|      1000 |      10|
  |      1000|            1002|        2|            1002|      3001 |      10|
  |      1000|            1002|        2|            1002|      3000 |       6|
  |      1000|            1002|        2|            1002|      1001 |      40|
  |      1000|            1002|        2|            1002|      4000 |       1|
  |      1000|            1002|        2|            1002|      2000 |     125|
  |      5000|            5002|        6|            5002|      3001 |      10|
  |      5000|            5002|        6|            5002|      2000 |     125|
  |      5000|            5002|        6|            5002|      1001 |      40|
  |      4000|            4001|        5|            4001|      1001 |      40|
  |      4000|            4001|        5|            4001|      2000 |     125|
  |      4000|            4001|        5|            4001|      3001 |      10|
  |      4000|            4001|        5|            4001|      1000 |      10|
  |      1000|            1001|        1|            1001|      3001 |      10|
  |      1000|            1001|        1|            1001|      1001 |      40|
  |      1000|            1001|        1|            1001|      3000 |       6|
  |      1000|            1001|        1|            1001|      1000 |      10|
  |      1000|            1001|        1|            1001|      2000 |     125|
  |      1000|            1001|        1|            1001|      4000 |       1|
  |      2000|            2001|        3|            2001|      2000 |     125|
  |      2000|            2001|        3|            2001|      3001 |      10|
  |      2000|            2001|        3|            2001|      1000 |      10|
  |      2000|            2001|        3|            2001|      4000 |       1|
  |      2000|            2001|        3|            2001|      1001 |      40|
  |      2000|            2001|        3|            2001|      3000 |       6|
  |      2000|            2001|        3|            2001|      3000 |       6|
  |      2000|            2001|        3|            2001|      3001 |      10|
  |      2000|            2001|        3|            2001|      2000 |     125|
  |      2000|            2001|        3|            2001|      1001 |      40|
  |      2000|            2001|        3|            2001|      4000 |       1|
  |      2000|            2001|        3|            2001|      1000 |      10|
  |      3000|            3001|        4|            3001|      1000 |      10|
  |      3000|            3001|        4|            3001|      1001 |      40|
  |      3000|            3001|        4|            3001|      3000 |       6|
  |      3000|            3001|        4|            3001|      2000 |     125|
  |      3000|            3001|        4|            3001|      3001 |      10|  


# Segundo escenario --------------------------------------------

Escenario: generar remitos con fecha "2020-05-16" quedando algunos artículos pendientes por falta de stock
Dado los articulos tienen el siguiente stock
  | articulo | stock |
  | 1000     | 5     |
  | 1001     | 470   |
  | 2000     | 647   |
  | 3000     | 5     |
  | 3001     | 30    |
  | 4000     | 0     |
  | 5000     | 100   |   
  | 6000     | 4     |    
Y que existen los siguientes artículos pedidos de pedidos anteriores a la fecha "2020-05-15" sin remito aún
  | Pedido | fechaPedido | Cliente | Domicilio | articulo | cantidad | precio |
  | 11     | 2020-05-14  | 6000    | 6001      | 5000     | 20       | 355.25 |
  | 11     | 2020-05-14  | 6000    | 6001      | 6000     | 1        | 450.10 |
  | 12     | 2020-05-14  | 7000    | 7001      | 5000     | 20       | 355.25 |
  | 12     | 2020-05-14  | 7000    | 7001      | 6000     | 1        | 450.10 |
  | 8      | 2020-05-15  | 8000    | 8001      | 1000     | 10       | 2.3    |
  | 8      | 2020-05-15  | 8000    | 8001      | 1001     | 40       | 3.1    |
  | 8      | 2020-05-15  | 8000    | 8001      | 2000     | 125      | 3.4    |
  | 8      | 2020-05-15  | 8000    | 8001      | 3000     | 6        | 0.45   |
  | 8      | 2020-05-15  | 8000    | 8001      | 3001     | 10       | 0.77   |
  | 8      | 2020-05-15  | 8000    | 8001      | 4000     | 1        | 390    |
  | 9      | 2020-05-15  | 9000    | 9002      | 1000     | 10       | 2.3    |
  | 9      | 2020-05-15  | 9000    | 9002      | 1001     | 40       | 3.1    |
  | 9      | 2020-05-15  | 9000    | 9002      | 2000     | 125      | 3.4    |
  | 9      | 2020-05-15  | 9000    | 9002      | 3000     | 6        | 0.45   |
  | 9      | 2020-05-15  | 9000    | 9002      | 3001     | 10       | 0.77   |
  | 9      | 2020-05-15  | 9000    | 9002      | 4000     | 1        | 390    |
  | 10     | 2020-05-15  | 10000   | 10001     | 1000     | 10       | 2.3    |
  | 10     | 2020-05-15  | 10000   | 10001     | 1001     | 40       | 3.1    |
  | 10     | 2020-05-15  | 10000   | 10001     | 2000     | 125      | 3.4    |
  | 10     | 2020-05-15  | 10000   | 10001     | 3000     | 6        | 0.45   |
  | 10     | 2020-05-15  | 10000   | 10001     | 3001     | 10       | 0.77   |
  | 10     | 2020-05-15  | 10000   | 10001     | 4000     | 1        | 390    |
Cuando solicito generar remitos para pedidos con fecha "2020-05-16"
Entonces se obtiene el siguiente resultado:
  """
  {
    "StatusCode": 200,
    "StatusText": "Remitos generados exitosamente",
    "data": {
      "cantidad": 5
    }
  }
  """
Y se generaron los siguientes remitos
  | Remito|Entregado|     Fecha |         Domicilio |
  |      7|   false | 2020-05-16|               6001|
  |      8|   false | 2020-05-16|               7001|
  |      9|   false | 2020-05-16|               8001|
  |     10|   false | 2020-05-16|               9002|
  |     11|   false | 2020-05-16|              10001|
Y se prepararon para la entrega los siguientes articulos pedido
  |   Cliente| DomicilioPedido|   Remito| DomicilioRemito|   articulo|cantidad|
  |      6000|            6001|        7|            6001|      5000 |      20|
  |      6000|            6001|        7|            6001|      6000 |       1|
  |      7000|            7001|        8|            7001|      5000 |      20|
  |      7000|            7001|        8|            7001|      6000 |       1|
  |      8000|            8001|        9|            8001|      3001 |      10|
  |      8000|            8001|        9|            8001|      1001 |      40|
  |      8000|            8001|        9|            8001|      2000 |     125|
  |      9000|            9002|       10|            9002|      3001 |      10|
  |      9000|            9002|       10|            9002|      1001 |      40|
  |      9000|            9002|       10|            9002|      2000 |     125|
  |     10000|           10001|       11|           10001|      3001 |      10|
  |     10000|           10001|       11|           10001|      1001 |      40|
  |     10000|           10001|       11|           10001|      2000 |     125|

# Tercer escenario -----------------------------------------

Esquema del escenario: Actualiza stock faltante
Dado el artículo "<articulo>"
Cuando actualizo el stock en <cantidad>
Entonces se obtiene el siguiente resultado <resultado>

Ejemplos:
| articulo | cantidad | resultado                                                                                                             |
| 1000     | 35       | "{\"StatusCode\": 200,\"StatusText\": \"Stock actualizado correctamente\",\"data\":{\"codigo\": \"1000\",\"stock\": 40}}" |
| 3000     | 12       | "{\"StatusCode\": 200,\"StatusText\": \"Stock actualizado correctamente\",\"data\":{\"codigo\": \"3000\",\"stock\": 17}}" |
| 4000     | 50       | "{\"StatusCode\": 200,\"StatusText\": \"Stock actualizado correctamente\",\"data\":{\"codigo\": \"4000\",\"stock\": 50}}" |
| 5000     | 50       | "{\"StatusCode\": 200,\"StatusText\": \"Stock actualizado correctamente\",\"data\":{\"codigo\": \"5000\",\"stock\": 110}}" |

# Cuarto escenario -----------------------------------------

Escenario: generar remitos con fecha "2020-05-16" luego de stock renovado
Dado los articulos tienen el siguiente stock
  | articulo | stock |
  | 1000     | 40    |
  | 1001     | 350   |
  | 2000     | 272   |
  | 3000     | 17    |
  | 3001     | 0     |
  | 4000     | 50    |
  | 5000     | 110   |   
  | 6000     | 2     |    
Y que existen los siguientes artículos pedidos de pedidos anteriores a la fecha "2020-05-15" sin remito aún
  | Pedido | fechaPedido | Cliente | Domicilio | articulo | cantidad | precio |
  | 5      | 2020-05-12  | 3000    | 3001      | 4000     | 1        | 390    |
  | 6      | 2020-05-12  | 4000    | 4001      | 3000     | 6        | 0.45   |
  | 6      | 2020-05-12  | 4000    | 4001      | 4000     | 1        | 390    |
  | 7      | 2020-05-12  | 5000    | 5002      | 1000     | 10       | 2.3    |
  | 7      | 2020-05-12  | 5000    | 5002      | 3000     | 6        | 0.45   |
  | 7      | 2020-05-12  | 5000    | 5002      | 4000     | 1        | 390    |
  | 10     | 2020-05-15  | 10000   | 10001     | 1000     | 10       | 2.3    |
  | 10     | 2020-05-15  | 10000   | 10001     | 3000     | 6        | 0.45   |
  | 10     | 2020-05-15  | 10000   | 10001     | 4000     | 1        | 390    |
  
Cuando solicito generar remitos para pedidos con fecha "2020-05-16"
Entonces se obtiene el siguiente resultado:
  """
  {
    "StatusCode": 200,
    "StatusText": "Remitos generados exitosamente",
    "data": {
      "cantidad": 6
    }
  }
  """
Y se generaron los siguientes remitos
  | Remito|Entregado|     Fecha |         Domicilio |
  |     12|   false | 2020-05-16|               3001|
  |     13|   false | 2020-05-16|               4001|
  |     14|   false | 2020-05-16|               5002|
  |     15|   false | 2020-05-16|               8001|
  |     16|   false | 2020-05-16|               9002|
  |     17|   false | 2020-05-16|              10001|
Y se prepararon para la entrega los siguientes articulos pedido
  |   Cliente| DomicilioPedido|   Remito| DomicilioRemito|   articulo|cantidad|
  |      3000|            3001|       12|            3001|      4000 |       1|
  |      4000|            4001|       13|            4001|      3000 |       6|
  |      4000|            4001|       13|            4001|      4000 |       1|
  |      5000|            5002|       14|            5002|      1000 |      10|
  |      5000|            5002|       14|            5002|      3000 |       6|
  |      5000|            5002|       14|            5002|      4000 |       1|
  |      8000|            8001|       15|            8001|      1000 |      10|
  |      8000|            8001|       15|            8001|      3000 |       6|
  |      8000|            8001|       15|            8001|      4000 |       1|
  |      9000|            9002|       16|            9002|      1000 |      10|
  |      9000|            9002|       16|            9002|      3000 |       6|
  |      9000|            9002|       16|            9002|      4000 |       1|
  |     10000|           10001|       17|           10001|      1000 |      10|
  |     10000|           10001|       17|           10001|      3000 |       6|
  |     10000|           10001|       17|           10001|      4000 |       1|
